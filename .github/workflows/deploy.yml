name: Deploy to Production Server

on:
  workflow_run:
    workflows: ["Cypress Test"]
    types:
      - completed
    branches:
      - main

jobs:
  deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: self-hosted
    steps:  
    - name: Deploy to Server
      run: |
        "echo 'Connection Successful'"
        cd "C:\\Users\\Brandon Bejarano\\Documents\\GitHub\\Guaranty_Sheet_Metal"
        docker ps
        docker-compose down
        "echo 'Containers Shutdown Successfully'"
        git pull
        "echo 'Updated Main Successfully'"
        docker-compose -f docker-compose.production.yml up --build -d
        "echo 'Updated Containers Successfully'"
        
